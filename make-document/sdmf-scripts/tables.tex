\documentclass[oneside,11pt]{memoir}

% Fonts
\usepackage[T1]{fontenc}	% better output encoding
\usepackage{textcomp}		% For ASCII diacritics
\usepackage{lmodern}		% Latin Modern instad of CM
%\usepackage{inconsolata}	% better monospaced font
\usepackage[defaultsans]{droidsans} % straight quotes
\usepackage{microtype}		% fix the little things % comes after any fonts

% basics
\usepackage[textwidth=0.75\paperwidth]{geometry}	% Adjust margins
\usepackage{graphicx}	% now you can add pretty pictures
\usepackage{url} 		% makes urls look nicer
\usepackage[usenames,dvipsnames]{color} % adds colored text
\usepackage[font=footnotesize]{caption}	% more control over figure captions
\usepackage{xparse}		% nesting arguments within environments
\usepackage{underscore}	% better text underscores
\usepackage{marginnote}	% better margin notes
\usepackage{tabularx}	% more flexible tables
\usepackage[table,dvipsnames]{xcolor}	% alternating table colors
\usepackage{todonotes}	% backend organization. Also for some reason necessary for tikz
\usepackage{authblk} % author block
\usepackage{booktabs}
\usepackage{ltxtable}
\usepackage{upquote}
\usepackage[level]{datetime}
\shortdate


% Complex packages
\usepackage{tikz}		% nice flowcharts and stuff
\usepackage{tikzpagenodes}
\usetikzlibrary{positioning,calc}
\usepackage{tcolorbox} 	% frames
\usepackage{listings} 	% nice code formatting
\usepackage{dirtree}	% pretty directory trees
\usepackage{minted}

% Lists
\usepackage[ampersand]{easylist}	% Nicer syntax for creating lists
\usepackage{paralist}	% Allows inline lists %
% For citations using Bibtex
\usepackage{natbib}

% Hyperref
\usepackage[linkcolor=magenta,colorlinks=true]{hyperref} 	% allows hyperlinking % NEEDS TO BE LOADED LAST
\newcommand{\sdmf}{\textsc{sdmf}}

\renewcommand{\thesection}{\arabic{section}}
%\renewcommand{\thesubsection}{\arabic{section}.\arabic{subsection}}

\setsecnumdepth{subsection}

\title{Makefile Documentation}

\date{\today}
\author{}

\usepackage{titletoc}
\titlecontents*{section} % Section
	[0em]                  % Left
	{\space}               % Above code
	{\thecontentslabel~}   % Numbered format
	{}                     % Numberless format
	{}                     % Filler
	[\hspace{1em}]         % Separator
	
\makeatletter
\renewcommand*{\@tocmaketitle}{\noindent \textbf{\large Contents}}
\makeatother

\definecolor{lemon}{HTML}{F5ECCE}
\definecolor{keycolor}{RGB}{172, 42, 42}
\definecolor{mbleu}{RGB}{64,96,127}
\definecolor{vimvert}{RGB}{46, 139, 87}

\lstdefinestyle{global}{
	basicstyle=\ttfamily\scriptsize\color{black!90},%
	stringstyle=\itshape\color{magenta},%
	showstringspaces=false,%
	keywordstyle={[1]\bfseries\color{keycolor}},%
	keywordstyle={[2]\bfseries\color{mbleu}},%
	commentstyle=\color{blue}\slshape,%
	framexleftmargin=1mm,%
	backgroundcolor=\color{black!2},%
}

\lstdefinestyle{makefile}{
	otherkeywords={.SUFFIXES},
	morekeywords={SUFFIX, CPP_,},
	moredelim=[is][\color{mbleu}]{^}{:},
	style=global,%
	morecomment=[l][commentstyle]{\#},%
	emphstyle={\color{vimvert}},%
	moredelim=[s][\color{vimvert}]{\$(}{)}%
}

\begin{document}
	
	\begin{center}
		{\Huge \textbf{Makefile Documentation}}
		
		{\large Documenting makefiles: \texttt{\input{../sdmf-output/header.txt}} }
		
		\textit{\today}
	\end{center}
	
	\tableofcontents*
	
	\section{This File}
	\label{intro}
	
	This documentation covers the following makefiles, and was prepared on \today{} at \currenttime{} by \texttt{\input{../sdmf-output/user.txt}}
	
	\begin{description}
		\input{../sdmf-output/descriptions.txt}
	\end{description}
	
	\begin{center}
		\fbox{Note that the items are sorted uppercase, then lowercase: [A-Za-z]}
	\end{center}
	
	\section{Targets}
	\label{targets}
	
	\LTXtable{\textwidth}{targets.tex}	
	
	\section{Variables}
	\label{variables}
			
	\LTXtable{\textwidth}{variables.tex}
	
	\section{Intermediate Files}
	\label{intermediates}

	\begin{description}		
		\input{../sdmf-output/intermediates.txt}				
	\end{description}
	
	\newpage
	\newgeometry{scale=0.85, centering}
	\section{Makefiles}
	\label{makefiles}
		
	\lstset{language=make, 
		backgroundcolor=\color{lemon},
		showstringspaces=false,
		gobble=8,
		basicstyle=\small\ttfamily,
		breaklines=true,
		escapeinside={\%*}{*},
		upquote=true}
		
	\input{makefiles.tex}


	
\end{document}
	